{"id":"zaap-09m","title":"Voice tab UI: compact controls to give more room for chat transcript","description":"Voice tab bottom controls take too much vertical space. Workers have marked this closed without implementing it. THIS MUST ACTUALLY CHANGE THE LAYOUT.\n\n## Current state (VoiceChatView.swift lines ~99-135)\n- SessionPickerView is a full-width block above the mic area\n- VStack with spacing: 12 contains the mic button\n- Multiple separate HStack rows below for status indicators\n- The bottom section is tall and wastes space\n\n## REQUIRED OUTCOME â€” verify visually by reading the actual SwiftUI code:\nCollapse ALL bottom controls into a SINGLE HStack toolbar row:\n  [SessionPicker menu] ---- [status dot] ---- [mic button 44pt]\n\nThe transcript ScrollView above it should fill all remaining vertical space.\n\nRemove any VStack wrapping the mic button that adds extra vertical padding.\nThe 'Tap the mic to start' hint should float in the transcript area, not add height to the toolbar.\n\n## Verification\nAfter implementation, the bottom section should be ONE HStack row only. If VoiceChatView still has a VStack with multiple children below the ScrollView, the fix is incomplete.\n\n## File\nZaap/Zaap/VoiceChatView.swift","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T16:00:37.689385-07:00","created_by":"Zane","updated_at":"2026-02-27T16:50:11.818739-07:00","closed_at":"2026-02-27T16:50:11.818743-07:00"}
{"id":"zaap-0a2","title":"Background location delivery â€” ensure location updates POST even when app is backgrounded","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T11:56:33.06532-07:00","created_by":"micahmartin","updated_at":"2026-02-15T12:05:07.060835-07:00","closed_at":"2026-02-15T12:05:07.060838-07:00","dependencies":[{"issue_id":"zaap-0a2","depends_on_id":"zaap-c6c","type":"blocks","created_at":"2026-02-15T11:56:39.763371-07:00","created_by":"micahmartin"},{"issue_id":"zaap-0a2","depends_on_id":"zaap-t8f","type":"blocks","created_at":"2026-02-15T11:56:39.880064-07:00","created_by":"micahmartin"}]}
{"id":"zaap-0es","title":"Wire delivery services to log â€” record each POST result","description":"Update LocationDeliveryService, SleepDeliveryService, HeartRateDeliveryService, ActivityDeliveryService, and WorkoutDeliveryService to record each delivery attempt (success or failure) to the DeliveryLog after POSTing.","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-16T13:32:36.970461-07:00","created_by":"micahmartin","updated_at":"2026-02-16T14:08:57.591606-07:00","closed_at":"2026-02-16T14:08:57.59161-07:00","dependencies":[{"issue_id":"zaap-0es","depends_on_id":"zaap-9b7","type":"blocks","created_at":"2026-02-16T13:32:41.441654-07:00","created_by":"micahmartin"}]}
{"id":"zaap-0s7","title":"VoiceEngine â€” SFSpeechRecognizer continuous mode with VAD silence detection","description":"Implement VoiceEngine using SFSpeechRecognizer in continuous streaming mode. No push-to-talk â€” detect end of utterance via 1.5s silence threshold on recognition results. Emit transcripts via callback/publisher. Handle auth request, recognition errors, and audio session setup (AVAudioSession .playAndRecord, .defaultToSpeaker, .allowBluetooth). Handle AVAudioSession interruption notifications.","notes":"Implemented VoiceEngine with TDD. 25 tests passing. Protocol-based DI abstracts SFSpeechRecognizer, AVAudioEngine, AVAudioSession, and Timer. 1.5s silence VAD, min transcript length, interruption handling.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-20T10:16:01.96409-07:00","created_by":"zane","updated_at":"2026-02-20T21:26:01.21362-07:00","closed_at":"2026-02-20T21:26:01.213627-07:00"}
{"id":"zaap-0wt","title":"Fix persistent transcript accumulation: reset currentTranscript in stopListening()","description":"Voice tab accumulates all utterances into progressively longer messages WITHIN a single listening session (mic not tapped multiple times).\n\n## Root Cause\nSFSpeechRecognizer returns CUMULATIVE bestTranscriptionString for the lifetime of a recognition request. restartRecognition() was added but may not be working correctly â€” possible issues:\n1. Old task fires a final callback AFTER restart, repopulating currentTranscript with full accumulated text\n2. The 'utterance offset' approach is needed: track where the last emitted utterance ended, only send the NEW portion\n3. stopListening() still doesn't clear currentTranscript\n\n## Recommended Fix: Utterance Offset Tracking\nInstead of restarting the task (which has timing hazards), track the last emitted transcript length and only send words after that offset:\n\nvar lastEmittedLength = 0\n\nIn emitUtteranceIfValid():\n  let full = currentTranscript.trimmingCharacters(...)\n  let newPortion = String(full.dropFirst(lastEmittedLength)).trimmingCharacters(...)\n  guard newPortion.count \u003e= minimumTranscriptLength else { return }\n  onUtteranceComplete?(newPortion)\n  lastEmittedLength = full.count\n\nIn stopListening() / startListening():\n  lastEmittedLength = 0\n  currentTranscript = ''\n\nThis is safe even if the old task fires late callbacks.","status":"closed","priority":0,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T15:57:20.289925-07:00","created_by":"Zane","updated_at":"2026-02-27T16:25:29.842033-07:00","closed_at":"2026-02-27T16:25:29.842036-07:00"}
{"id":"zaap-16z","title":"Step count \u0026 activity reader + delivery â€” daily steps, distance, active energy","description":"Read step count, walking/running distance, and active energy burned from HealthKit. POST daily summary to webhook.","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T19:31:38.833756-07:00","created_by":"micahmartin","updated_at":"2026-02-15T19:40:51.232339-07:00","closed_at":"2026-02-15T19:40:51.232342-07:00"}
{"id":"zaap-1b3","title":"Sleep webhook delivery â€” wire SleepDataReader to WebhookClient POST","description":"Connect existing SleepDataReader to WebhookClient. POST morning sleep summary (stages, duration, quality) to /hooks/health. Trigger on app wake or background schedule.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-15T19:31:38.416237-07:00","created_by":"micahmartin","updated_at":"2026-02-15T20:07:20.486254-07:00","closed_at":"2026-02-15T20:07:20.486256-07:00"}
{"id":"zaap-1nr","title":"Pairing flow shows 'Disconnected' in red before pending approval â€” confusing UX","description":"During pairing, UI shows red 'Disconnected' before showing pending approval state. This is alarming.\n\n## Acceptance Criteria\n- [ ] When NOT_PAIRED is received from gateway, the UI must show a neutral waiting state (e.g. 'Waiting for approval...' in gray/default color) â€” NOT a red error state\n- [ ] The red error state must only appear for genuine errors (challenge failed, network error)\n- [ ] Verify: in VoiceChatView or pairing view, the NOT_PAIRED path must not set any .red or error-colored status\n- [ ] Test the flow: connect unpaired device â†’ should see 'Waiting for approval' (not red 'Disconnected')","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T17:55:34.562148-07:00","created_by":"Zane","updated_at":"2026-02-27T21:25:24.041504-07:00","closed_at":"2026-02-27T21:25:24.041509-07:00"}
{"id":"zaap-1ze","title":"Add field labels to distinguish Hooks Bearer Token vs Gateway Bearer Token in settings","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","created_at":"2026-02-26T09:35:03.584376-07:00","created_by":"zane","updated_at":"2026-02-26T21:50:18.57675-07:00","closed_at":"2026-02-26T21:50:18.576755-07:00"}
{"id":"zaap-2xf","title":"HealthKit sleep data reader â€” read sleep analysis from HealthKit","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T11:56:33.231381-07:00","created_by":"micahmartin","updated_at":"2026-02-15T12:41:39.765804-07:00","closed_at":"2026-02-15T12:41:39.765806-07:00","dependencies":[{"issue_id":"zaap-2xf","depends_on_id":"zaap-7xm","type":"blocks","created_at":"2026-02-15T11:56:39.994572-07:00","created_by":"micahmartin"}]}
{"id":"zaap-3ig","title":"Set up git remote and push to GitHub","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-15T12:04:30.935615-07:00","created_by":"micahmartin","updated_at":"2026-02-15T12:04:56.928018-07:00","closed_at":"2026-02-15T12:04:56.928018-07:00","close_reason":"Closed","labels":["status:in-progress"]}
{"id":"zaap-3ig.1","title":"State change: status â†’ in-progress","description":"Set status to in-progress","status":"closed","priority":4,"issue_type":"event","assignee":"micahmartin","created_at":"2026-02-15T12:04:50.002565-07:00","created_by":"micahmartin","updated_at":"2026-02-15T19:55:46.114042-07:00","closed_at":"2026-02-15T19:55:46.114045-07:00","dependencies":[{"issue_id":"zaap-3ig.1","depends_on_id":"zaap-3ig","type":"parent-child","created_at":"2026-02-15T12:04:50.004043-07:00","created_by":"micahmartin"}]}
{"id":"zaap-3nc","title":"Session picker: list and switch sessions for voice chat","description":"Allow the user to select which session the voice chat connects to.\n\n## Gateway API\nUse the gateway method 'sessions.list' (already available via the WebSocket connection) with params:\n- limit: reasonable cap (e.g. 20)\n- activeMinutes: optional filter for recently active sessions\n- includeDerivedTitles: true â€” derives a title from the first user message\n- includeLastMessage: true â€” shows a preview of the most recent message\n\n## UX\n- Add a session picker to the voice chat screen (e.g. a picker/sheet above the mic button)\n- Show session label or derived title + last message preview\n- Default to the current/main session\n- Selected session key is passed along with voice.transcript events so the gateway routes to the correct session","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-26T21:08:52.055884-07:00","created_by":"Zane","updated_at":"2026-02-26T22:11:36.496703-07:00","closed_at":"2026-02-26T22:11:36.496708-07:00"}
{"id":"zaap-3sj","title":"Hook session routing â€” location data should persist to memory","description":"Location webhooks create isolated hook sessions that are inaccessible from the main/channel sessions. The agent can't read or persist the location data. Options: 1) Set hooks.defaultSessionKey so all hooks route to a known session. 2) Change hook action to 'wake' instead of 'agent' so it injects into main session. 3) Have the hook handler write directly to memory files. The goal: when Micah sends location, Zane should store it in daily memory and be able to recall it.","status":"closed","priority":1,"issue_type":"bug","assignee":"zane","created_at":"2026-02-19T16:10:05.753089-07:00","created_by":"zane","updated_at":"2026-02-19T21:20:38.529098-07:00","closed_at":"2026-02-19T21:20:38.529101-07:00","comments":[{"id":1,"issue_id":"zaap-3sj","author":"zane","text":"Fixed: Changed location hook from action:agent (isolated session) to action:wake (injects into main session). The wake action enqueues the location data as a system event in the main agent session, where it has full context to persist to memory files. Also removed agentId and deliver fields (not applicable to wake action). Config change in ~/.openclaw/openclaw.json. Gateway auto-reloaded.","created_at":"2026-02-19T23:24:49Z"}]}
{"id":"zaap-3t6","title":"App icon â€” creative and fun Zaap branding","description":"Design and generate a creative, fun app icon for Zaap. Think lightning bolt / zap energy theme. Produce all required sizes for iOS (1024x1024 master + AppIcon asset catalog). Should look great on home screen.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-16T13:32:37.238201-07:00","created_by":"micahmartin","updated_at":"2026-02-16T13:34:46.988539-07:00","closed_at":"2026-02-16T13:34:46.988543-07:00"}
{"id":"zaap-47b","title":"Get all tests passing","description":"All tests must pass before any bead can be considered done.\n\nCurrent failures to fix:\n1. GatewayConnectionTests.testChallengeResponseIncludesDeviceSignature â€” expects old 'ios-node'/'voice' values, needs updating to 'openclaw-ios'/[]\n2. ActivityReaderTests â€” HealthKit availability tests fail on modern simulators; add XCTSkipIf guard\n3. HeartRateReaderTests â€” same HealthKit issue\n\nRun tests with:\n  cd ~/Projects/zaap/Zaap \u0026\u0026 xcodebuild test -scheme Zaap -destination 'platform=iOS Simulator,name=iPhone 17 Pro'\n\nAll tests must be green before closing this bead.","status":"closed","priority":0,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-26T21:56:09.933446-07:00","created_by":"Zane","updated_at":"2026-02-26T22:30:57.0596-07:00","closed_at":"2026-02-26T22:30:57.059602-07:00"}
{"id":"zaap-4a3","title":"Dev/Prod settings toggle in simulator Developer section","description":"In simulator builds (targetEnvironment(simulator)), add a 'Connection Mode' toggle to the Developer section in SettingsView. When set to 'Dev': host=localhost:8788, token=mock. When set to 'Prod': populate with real production values. Switching immediately updates UserDefaults keys settings.webhookURL and settings.authToken and restarts tracking services. Store the current mode in UserDefaults key 'settings.devMode' (Bool). Use #if targetEnvironment(simulator) so this code is excluded from TestFlight builds. Build verify with xcodebuild build for simulator.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-21T11:05:01.245662-07:00","created_by":"zane","updated_at":"2026-02-21T11:07:07.442061-07:00","closed_at":"2026-02-21T11:07:07.442065-07:00"}
{"id":"zaap-4jt","title":"Send Now buttons â€” manual trigger for each data source","description":"Add a 'Send Now' button next to each data source toggle in Settings. Tapping it immediately reads the latest data and POSTs it to the webhook. Shows success/failure feedback. Useful for testing each service independently without waiting for background triggers.","status":"closed","priority":1,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-16T21:02:36.370524-07:00","created_by":"micahmartin","updated_at":"2026-02-16T22:31:17.654165-07:00","closed_at":"2026-02-16T22:31:17.65417-07:00","dependencies":[{"issue_id":"zaap-4jt","depends_on_id":"zaap-fkp","type":"blocks","created_at":"2026-02-17T06:42:32.343039-07:00","created_by":"micahmartin"}]}
{"id":"zaap-65l","title":"Add gateway event logging to diagnose NO_REPLY responses","description":"NO_REPLY is coming from the gateway/server, not the client. The client-side text extraction in handleChatEvent() is also fragile (expects message.content[0].text) and fails silently. Add logging to: (1) Print raw payload in handleGatewayEvent before processing. (2) Log when text extraction returns nil. (3) Log session key comparisons. (4) Log when events are silently dropped. This will reveal whether NO_REPLY is a server response, a payload structure mismatch, or a session key filtering issue.","status":"open","priority":1,"issue_type":"bug","owner":"micahmartin@gmail.com","created_at":"2026-02-28T14:41:04.528056-07:00","created_by":"Micah","updated_at":"2026-02-28T14:41:04.528056-07:00"}
{"id":"zaap-6gx","title":"Add Test Connection button to also test gateway bearer token connection","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","created_at":"2026-02-26T09:34:54.134315-07:00","created_by":"zane","updated_at":"2026-02-26T21:53:29.87213-07:00","closed_at":"2026-02-26T21:53:29.872137-07:00"}
{"id":"zaap-6vv","title":"Voice tab shows messages from all sessions â€” must filter to selected session only","description":"The gateway broadcasts chat events for all sessions to the node. VoiceChatCoordinator displays every event without checking which session it belongs to. Messages from the #zaap channel (and others) appear in the voice chat transcript.\n\n## Fix\nIn handleGatewayEvent / handleChatEvent, check that the event's sessionKey matches self.sessionKey before processing.\n\nThe chat event payload likely contains a 'sessionKey' or 'key' field identifying which session it belongs to. Check:\n- payload['sessionKey']\n- payload['session']  \n- payload['key']\n\nLog what fields are present to identify the correct field name.\n\nOnly process events where payload sessionKey == self.sessionKey.\n\n## Acceptance Criteria\n- [ ] Add logging to print all keys in incoming chat event payloads\n- [ ] Identify the session identifier field in the payload\n- [ ] Add guard: only process chat events matching self.sessionKey\n- [ ] Verify: messages from Discord channels do NOT appear in the voice tab\n- [ ] Verify: responses to voice prompts sent via the main session DO appear\n\n## Files\nZaap/Zaap/VoiceChatCoordinator.swift","status":"closed","priority":1,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T18:04:41.86029-07:00","created_by":"Zane","updated_at":"2026-02-27T21:11:20.638773-07:00","closed_at":"2026-02-27T21:11:20.638775-07:00"}
{"id":"zaap-6xh","title":"Mic button: blue (idle/start) and red (active/stop) only â€” remove other states","description":"Mic button has too many states. Needs exactly two.\n\n## Acceptance Criteria\n- [ ] Mic button is BLUE when idle (tap to start)\n- [ ] Mic button is RED when active (any of: listening, processing, speaking) â€” tap to stop\n- [ ] No other colors or states on the mic button itself\n- [ ] Verify: grep VoiceChatView.swift for micButtonColor â€” must return exactly .blue or .red (no other colors)\n- [ ] Status indicators (listening/processing/speaking distinction) may appear elsewhere (e.g. statusDot) but NOT on the mic button itself","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T17:55:33.760344-07:00","created_by":"Zane","updated_at":"2026-02-27T21:22:39.51348-07:00","closed_at":"2026-02-27T21:22:39.513482-07:00"}
{"id":"zaap-7km","title":"Dashboard: use @Query for reactive live updates instead of onAppear","description":"DashboardView uses .onAppear { loadData() } which only fires once on tab appear. The chart doesn't populate on app open if data exists, and doesn't update live when new deliveries come in. Fix: replace the manual loadData() approach with @Query(sort: \\[SortDescriptor(\\DeliveryRecord.timestamp)]) var records: [DeliveryRecord] â€” SwiftData will reactively update the view whenever new records are inserted. Rewrite the chart data transformation as a computed property on the @Query results. Remove the DeliveryLogService dependency from DashboardView entirely.","status":"closed","priority":0,"issue_type":"bug","assignee":"zane","created_at":"2026-02-20T14:49:39.437289-07:00","created_by":"zane","updated_at":"2026-02-20T14:50:59.154961-07:00","closed_at":"2026-02-20T14:50:59.154965-07:00"}
{"id":"zaap-7xm","title":"Xcode project scaffolding â€” SwiftUI app with bundle ID, Info.plist, location permissions","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T11:56:32.394424-07:00","created_by":"micahmartin","updated_at":"2026-02-15T12:00:57.53748-07:00","closed_at":"2026-02-15T12:00:57.537486-07:00"}
{"id":"zaap-7yv","title":"Echo cancellation still broken â€” TTS audio transcribed as user speech (fox face)","description":"The mic is still picking up TTS output. Evidence: assistant says 'ðŸ¦Š' (fox face emoji), mic transcribes it as 'fox face'. The stopListening()/startListening() approach is not working â€” either timing is off or AEC doesn't work in the simulator.\n\n## Root Cause\nThe onStateChange callback stops mic when speaking starts, but there is likely a timing gap:\n1. TTS starts before stopListening() fully takes effect\n2. OR startListening() is called too soon after TTS ends while audio tail is still in the buffer\n3. OR in the simulator, voiceChat mode provides no AEC\n\n## Fix\nAfter TTS finishes (speaker state â†’ .idle), add a delay before restarting mic (e.g. 800ms) to let audio tail clear. Also verify stopListening() is called synchronously on the main thread BEFORE any audio plays.\n\nConsider: on simulator, never use AEC â€” always mute mic fully during TTS.\n\n## Acceptance Criteria\n- [ ] Speak to the assistant, let it respond via TTS â€” the response text must NOT appear as a user message bubble\n- [ ] 'fox face' or any TTS-spoken words must NOT appear in the transcript\n- [ ] Test at least 2 back-and-forth exchanges without echo\n- [ ] Add a delay of 500-1000ms after speaker state â†’ .idle before calling startListening()\n\n## File\nZaap/Zaap/VoiceChatCoordinator.swift (onStateChange handler)","status":"closed","priority":0,"issue_type":"task","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-28T07:58:08.700756-07:00","created_by":"Zane","updated_at":"2026-02-28T08:10:56.37208-07:00","closed_at":"2026-02-28T08:10:56.372082-07:00"}
{"id":"zaap-89d","title":"GatewayConnection â€” WS client, connect handshake, message routing, reconnect","description":"Implement GatewayConnection: WebSocket client connecting to wss://\u003chost\u003e:18789, send connect.challenge response with device signature, handle hello-ok, route incoming messages by type (node.invoke.request, chat.event, etc.), exponential backoff reconnect (1s/2s/4s/8s/30s max), NWPathMonitor for network changes. Depends on NodePairingManager.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-20T10:16:01.795438-07:00","created_by":"zane","updated_at":"2026-02-20T22:29:47.4766-07:00","closed_at":"2026-02-20T22:29:47.476603-07:00","dependencies":[{"issue_id":"zaap-89d","depends_on_id":"zaap-aqb","type":"blocks","created_at":"2026-02-20T10:16:28.042763-07:00","created_by":"zane"}]}
{"id":"zaap-8by","title":"Dashboard screen with 7-day bar chart","description":"Home screen using Swift Charts. Grouped bar chart showing delivery counts per data type per day for the past 7 days. Color-coded bars: location, sleep, heart rate, activity, workouts. Reads from DeliveryLog.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-16T13:32:36.643062-07:00","created_by":"micahmartin","updated_at":"2026-02-16T13:47:15.375013-07:00","closed_at":"2026-02-16T13:47:15.375016-07:00","dependencies":[{"issue_id":"zaap-8by","depends_on_id":"zaap-9b7","type":"blocks","created_at":"2026-02-16T13:32:41.152663-07:00","created_by":"micahmartin"}]}
{"id":"zaap-8kq","title":"Fix voice transcript accumulation â€” restart recognition task after each utterance","description":"Every voice prompt sent to the gateway contains the full accumulated transcript since listening started, not just the current utterance.\n\n## Root Cause\nIn VoiceEngine.emitUtteranceIfValid():\n1. Emits the transcript via onUtteranceComplete\n2. Clears currentTranscript = \"\"\n3. BUT does NOT restart the recognition task\n\nSFSpeechRecognizer recognition tasks accumulate text for their entire lifetime. The next result.bestTranscriptionString callback restores the full accumulated text, overwriting the cleared currentTranscript.\n\n## Fix\nAfter emitting an utterance, restart the recognition task:\n- Cancel and nil out the current recognitionTask and recognitionRequest\n- Start a new recognition request immediately (so listening continues without interruption)\n- The new task starts with an empty transcript\n\nIn emitUtteranceIfValid(), after clearing currentTranscript, call a restartRecognition() method that tears down the current task and starts a fresh one.\n\n## Files\n- Zaap/Zaap/VoiceEngine.swift: emitUtteranceIfValid(), add restartRecognition()","status":"closed","priority":0,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T14:26:49.478401-07:00","created_by":"Zane","updated_at":"2026-02-27T15:53:08.089291-07:00","closed_at":"2026-02-27T15:53:08.089294-07:00"}
{"id":"zaap-8kt","title":"Device ID changes on each pairing request â€” should be stable per device","description":"Simulator Keychain is wiped on every reinstall, generating a new keypair and device ID each time.\n\n## Acceptance Criteria\n- [ ] Add SimulatorKeychain class in VoiceEngineAdapters.swift that implements KeychainAccessing using UserDefaults\n- [ ] In NodePairingManager.init(), use SimulatorKeychain() when targetEnvironment(simulator), RealKeychain() otherwise\n- [ ] Run app in simulator twice (stop and re-run without clean build) â€” device ID must be identical both times\n- [ ] Verify by grepping: NodePairingManager.swift must contain '#if targetEnvironment(simulator)'\n- [ ] Test: add NodePairingManagerTests that mock both paths","status":"closed","priority":1,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T17:55:33.472992-07:00","created_by":"Zane","updated_at":"2026-02-27T21:06:10.495908-07:00","closed_at":"2026-02-27T21:06:10.495911-07:00"}
{"id":"zaap-8v2","title":"Dashboard @Query shows no data â€” DeliveryLogService context mismatch","description":"After switching DashboardView to @Query, the chart shows no data even after Send Now succeeds. Root cause likely: DeliveryLogService uses modelContainer.mainContext but the @Query environment may be observing a different context instance, OR context.save() is never called so inserts aren't persisted/visible. Fix options: 1) Add explicit context.save() in DeliveryLogService.record(). 2) Pass the model context via @Environment and use it in DeliveryLogService. 3) Revert to onAppear + add a publisher/notification to trigger reload after each delivery. Must verify with a Send Now after fix.","status":"closed","priority":0,"issue_type":"bug","assignee":"zane","created_at":"2026-02-20T17:29:27.781603-07:00","created_by":"zane","updated_at":"2026-02-20T17:31:49.789005-07:00","closed_at":"2026-02-20T17:31:49.789008-07:00"}
{"id":"zaap-8vk","title":"Remove 'New conversation' from session selector â€” require existing session","description":"Session picker includes a 'New conversation' / nil option. Remove it entirely.\n\n## Acceptance Criteria\n- [ ] Grep SessionPickerView.swift and SessionPickerViewModel.swift â€” must contain NO reference to 'New conversation' string\n- [ ] selectedSessionKey must never be nil after initialization (default is 'agent:main:main')\n- [ ] The Picker must only show actual sessions from the gateway + the static Main fallback\n- [ ] Verify: picker shows 'Main' as default; no nil/empty option in the list","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T17:55:34.904289-07:00","created_by":"Zane","updated_at":"2026-02-27T21:26:08.751941-07:00","closed_at":"2026-02-27T21:26:08.751943-07:00"}
{"id":"zaap-8zj","title":"Voice tab pairing UI when gateway not paired","description":"VoiceChatView should check NodePairingManager.isPaired (or equivalent). If not paired, show a PairingView instead of the mic UI. PairingView should: (1) show the node's device ID and public key fingerprint, (2) show instructions: 'Run: openclaw nodes approve \u003cid\u003e on your gateway', (3) show a 'Request Pairing' button that calls gateway connect and sends node.pair.request, (4) show live status (idle/requesting/awaiting approval/paired/failed), (5) once paired automatically transition to the voice mic UI. NodePairingManager needs an isPaired computed property (has stored token). Build verify with xcodebuild build for simulator.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-21T11:05:01.522049-07:00","created_by":"zane","updated_at":"2026-02-21T11:09:47.881461-07:00","closed_at":"2026-02-21T11:09:47.881464-07:00"}
{"id":"zaap-9b7","title":"Delivery log persistence â€” store webhook deliveries locally","description":"Create a DeliveryLog model and persistence layer (SwiftData or JSON file). Each webhook POST records: data type (location/sleep/hr/activity/workout), timestamp, success/fail. Provides query API for last N days grouped by type and day.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-16T13:32:36.427054-07:00","created_by":"micahmartin","updated_at":"2026-02-16T13:50:30.721355-07:00","closed_at":"2026-02-16T13:50:30.72136-07:00"}
{"id":"zaap-9ou","title":"Clean up pairing view","description":"Improvements to the pairing view UX:\n\n1. Show pairing view immediately when device is not paired (no flash of mic UI first)\n2. Also show pairing view when connection attempts indicate pairing is needed (NOT_PAIRED response)\n3. Remove the 'Copy Device ID' button â€” no longer needed\n\nThe current flow shows the mic UI briefly before flipping to pairing (due to stale token check timing). Should be clean and immediate.","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-26T21:06:57.306492-07:00","created_by":"Zane","updated_at":"2026-02-26T22:17:34.968295-07:00","closed_at":"2026-02-26T22:17:34.9683-07:00"}
{"id":"zaap-a0t","title":"ResponseSpeaker â€” AVSpeechSynthesizer with streaming token buffering","description":"Implement ResponseSpeaker using AVSpeechSynthesizer. Buffer streaming tokens from gateway until a sentence boundary, then speak. Support interrupt() to stop mid-speech when user starts talking. Use iOS 17+ enhanced voices. Publish state (idle/speaking) for UI.","notes":"Commit: c721ea5. 22 tests passing.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-20T10:16:02.133784-07:00","created_by":"zane","updated_at":"2026-02-20T21:10:50.060401-07:00","closed_at":"2026-02-20T21:10:50.060407-07:00"}
{"id":"zaap-a76","title":"Fix session picker: always show picker, not static text when sessions empty","description":"SessionPickerView shows a static Text('New conversation') when sessions.isEmpty, which is not tappable. The Picker only renders when sessions have loaded.\n\n## Fix\nAlways render the Picker. When sessions haven't loaded yet, show just the 'New conversation' option in the Picker so the user can still interact with it. Remove the empty/loading branches that show non-interactive Text.\n\n## SessionPickerView.swift\nReplace the conditional Text/ProgressView with a single Picker that always includes the 'New conversation' option, plus loaded sessions when available. The loading spinner can be a small inline indicator rather than replacing the whole picker.","status":"closed","priority":1,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T14:30:07.617461-07:00","created_by":"Zane","updated_at":"2026-02-27T15:00:08.488415-07:00","closed_at":"2026-02-27T15:00:08.488433-07:00"}
{"id":"zaap-a8k","title":"Chat transcript does not auto-scroll â€” new messages fall off bottom of screen","description":"New messages in the voice chat transcript are not visible â€” they appear below the screen and the view doesn't scroll.\n\n## Acceptance Criteria\n- [ ] VoiceChatView.swift must use ScrollViewReader wrapping the LazyVStack\n- [ ] An .onChange(of: viewModel.entries) or .onChange(of: viewModel.entries.count) must call proxy.scrollTo(last.id, anchor: .bottom)\n- [ ] Verify: send a voice message and receive a response â€” the response bubble must be visible without manual scrolling\n- [ ] The scroll must animate smoothly (withAnimation)","status":"closed","priority":1,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T17:55:34.016131-07:00","created_by":"Zane","updated_at":"2026-02-27T21:05:47.826395-07:00","closed_at":"2026-02-27T21:05:47.826412-07:00"}
{"id":"zaap-aad","title":"Request log in Settings â€” show last 10 webhook requests","description":"Add a scrollable log section at the bottom of SettingsView showing the last 10 webhook requests. Each entry shows: timestamp, service path (/location, /sleep, etc.), HTTP status code, response time (ms), JSON request body (collapsible or truncated), and error message if failed. Use an in-memory ring buffer (no persistence needed). WebhookClient should append to the log on every request. Log entries should be color-coded: green for success, red for errors.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-19T16:16:30.288096-07:00","created_by":"zane","updated_at":"2026-02-19T18:59:00.289934-07:00","closed_at":"2026-02-19T18:59:00.289936-07:00"}
{"id":"zaap-agz","title":"mock-gateway: local webhook server for simulator testing","description":"Lightweight HTTP server saved under mock-gateway/ in the zaap project. Accepts POST /hooks/* and returns 200 OK. Reads a live config.json that can be edited mid-run to control: failure mode (none/always/path-specific), HTTP status code override, and optional response delay. No restart required â€” server polls config file for changes. Point the simulator at localhost:\u003cport\u003e to test without hitting the real gateway.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-21T09:36:56.824451-07:00","created_by":"zane","updated_at":"2026-02-21T09:38:28.788861-07:00","closed_at":"2026-02-21T09:38:28.788863-07:00"}
{"id":"zaap-ake","title":"Add delay before mic restart after TTS finishes","description":"When TTS finishes and conversation mode is on, the mic restarts immediately with no delay. This can catch the tail end of TTS audio in the buffer, causing echo â€” especially on simulator where there is no hardware AEC. Add a small delay (e.g. 500ms) after speaker goes idle before calling voiceEngine.startListening(). Guard against conversation mode being toggled off during the delay.","status":"open","priority":2,"issue_type":"bug","owner":"micahmartin@gmail.com","created_at":"2026-02-28T14:41:10.072821-07:00","created_by":"Micah","updated_at":"2026-02-28T14:41:10.072821-07:00"}
{"id":"zaap-aqb","title":"NodePairingManager â€” Ed25519 keypair, Keychain storage, pairing WS flow","description":"Implement NodePairingManager: generate Ed25519 keypair on first launch and store in iOS Keychain, initiate node.pair.request over WebSocket (nodeId=sha256(publicKey), displayName='Zaap (iPhone)', platform='iOS', caps=['voice']), handle pairing approval/rejection from gateway, store issued token in Keychain. Follows the pairing flow in .braids/iterations/005/z75-voice-chat-architecture.md.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-20T10:16:01.631142-07:00","created_by":"zane","updated_at":"2026-02-20T21:02:24.412796-07:00","closed_at":"2026-02-20T21:02:24.4128-07:00"}
{"id":"zaap-biq","title":"Pre-push git hook: 90% code coverage minimum","description":"Add a pre-push git hook that runs xcodebuild test with coverage enabled, parses results with xcrun xccov, and fails the push if any source file is below 90% coverage. Script lives in scripts/pre-push (tracked), symlinked into .git/hooks/pre-push. AGENTS.md should document the setup step.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-19T09:03:05.095004-07:00","created_by":"zane","updated_at":"2026-02-19T09:35:58.921919-07:00","closed_at":"2026-02-19T09:35:58.921921-07:00"}
{"id":"zaap-bom","title":"README â€” app overview and OpenClaw webhook setup guide","description":"Write a comprehensive README.md for the Zaap repo. Should include: 1) What Zaap does (personal telemetry relay â€” location, sleep, heart rate, activity, workouts). 2) How to build and install via TestFlight. 3) CRITICAL: Step-by-step guide for another OpenClaw instance to set up all the webhook mappings this app calls (/hooks/location, /hooks/sleep, /hooks/heartrate, /hooks/activity, /hooks/workout). Include example openclaw.json hooks config with all 5 mappings and suggested messageTemplates. 4) App settings (hostname, bearer token). 5) Privacy/permissions overview.","status":"closed","priority":2,"issue_type":"task","assignee":"zane","created_at":"2026-02-18T08:15:17.532743-07:00","created_by":"micahmartin","updated_at":"2026-02-19T09:35:21.64193-07:00","closed_at":"2026-02-19T09:35:21.641936-07:00"}
{"id":"zaap-c4w","title":"Mute mic while speaker is talking to prevent feedback loop","description":"The TTS speaker output is being picked up by the microphone, causing the assistant to respond to itself in a loop.\n\n## Root Cause\nVoiceEngine continues listening while ResponseSpeaker is playing TTS. The speaker audio feeds back into SFSpeechRecognizer.\n\n## Fix\nPause/stop listening when the speaker starts talking, resume when it finishes.\n\nIn VoiceChatCoordinator:\n- When speaker state changes to .speaking â†’ call voiceEngine.stopListening()\n- When speaker finishes (speakImmediate/flush completes) â†’ call voiceEngine.startListening() if session is still active\n\nResponseSpeaker should notify when it finishes speaking. The delegate/callback pattern already exists (onUtteranceComplete in VoiceEngine). ResponseSpeaker needs a similar completion callback, OR VoiceChatCoordinator should check speaker.state before restarting the mic.\n\n## Current flow (broken)\nlistening â†’ transcript sent â†’ speaking starts â†’ mic still on â†’ picks up TTS â†’ loop\n\n## Correct flow\nlistening â†’ transcript sent â†’ stop mic â†’ speaking starts â†’ speaking ends â†’ resume mic","status":"closed","priority":0,"issue_type":"task","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T07:08:18.428194-07:00","created_by":"Zane","updated_at":"2026-02-27T07:10:28.979827-07:00","closed_at":"2026-02-27T07:10:28.97983-07:00"}
{"id":"zaap-c6c","title":"Location manager â€” CLLocationManager with significant location change monitoring","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T11:56:32.56206-07:00","created_by":"micahmartin","updated_at":"2026-02-15T12:02:57.284176-07:00","closed_at":"2026-02-15T12:02:57.284179-07:00","dependencies":[{"issue_id":"zaap-c6c","depends_on_id":"zaap-7xm","type":"blocks","created_at":"2026-02-15T11:56:39.402804-07:00","created_by":"micahmartin"}]}
{"id":"zaap-clj","title":"Remove redundant Summary section from Settings","status":"closed","priority":2,"issue_type":"task","assignee":"zane","created_at":"2026-02-21T10:20:50.096889-07:00","created_by":"zane","updated_at":"2026-02-21T10:21:26.441303-07:00","closed_at":"2026-02-21T10:21:26.441306-07:00"}
{"id":"zaap-d0j","title":"Voice integration â€” wire VoiceEngine â†’ GatewayConnection â†’ ResponseSpeaker","description":"Wire up the full voice pipeline: VoiceEngine transcript â†’ GatewayConnection voice.transcript event â†’ receive chat.event stream â†’ ResponseSpeaker speaks response. Handle interrupts (user speaks while TTS playing). Add pairing UI to Settings (enter gateway address, pair button, paired status). Requires VoiceChatView, GatewayConnection, VoiceEngine, ResponseSpeaker.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-20T10:16:02.582402-07:00","created_by":"zane","updated_at":"2026-02-20T23:53:13.546989-07:00","closed_at":"2026-02-20T23:53:13.546992-07:00","dependencies":[{"issue_id":"zaap-d0j","depends_on_id":"zaap-l6q","type":"blocks","created_at":"2026-02-20T10:16:28.841193-07:00","created_by":"zane"}]}
{"id":"zaap-d1o","title":"WorkoutReader: clarify noData error message to say '24 hours'","description":"The noData error message is vague ('no workout data in the requested time window'). Update it to specifically say 'No workouts found in the last 24 hours'. Check WorkoutReader.swift for the WorkoutError.noData case and update the errorDescription. Also check if the UI surfaces this message anywhere and update accordingly.","status":"closed","priority":3,"issue_type":"task","assignee":"Zane","created_at":"2026-02-20T10:29:00.852766-07:00","created_by":"zane","updated_at":"2026-02-27T07:30:15.290826-07:00","closed_at":"2026-02-27T07:30:15.290831-07:00"}
{"id":"zaap-dje","title":"Add discreet 'Copy transcript' button to voice tab for debugging","description":"Add a small, unobtrusive button in the voice tab that copies the last 10 conversation messages to the clipboard as plain text. Used for sharing transcript state without screenshots.\n\n## Requirements\n- Small, subtle UI â€” not prominent. E.g. a tiny clipboard icon (doc.on.doc) in the corner, or a long-press gesture on the transcript area\n- Copies last 10 entries from the conversation log (user + assistant messages)\n- Format: each line as '[User]: text' or '[Zane]: text'\n- Shows brief 'Copied!' feedback (UIPasteboard + overlay toast or .alert)\n- Dev-only is fine but not required\n\n## Acceptance Criteria\n- [ ] Button/gesture exists in VoiceChatView\n- [ ] Copies last min(10, messages.count) entries to UIPasteboard.general.string\n- [ ] Brief visual confirmation shown after copy\n- [ ] Grep VoiceChatView.swift for UIPasteboard â€” must be present","status":"closed","priority":2,"issue_type":"task","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-28T08:04:38.880808-07:00","created_by":"Zane","updated_at":"2026-02-28T08:05:13.918538-07:00","closed_at":"2026-02-28T08:05:13.918541-07:00"}
{"id":"zaap-e44","title":"Fix session picker race condition and continuation leak","description":"Session picker is empty due to multiple issues: (1) Race condition: loadSessions() called in gatewayDidConnect() via async Task, but gateway may disconnect before it runs. listSessions() checks state==.connected and throws, error is silently caught. (2) pendingSessionListContinuation is never cleaned up on disconnect â€” request hangs forever. (3) sessionPicker is a weak var that could be nil when gatewayDidConnect fires. Fix: clean up continuation on disconnect (resume with error), add state check before loadSessions, consider strong reference for sessionPicker.","status":"open","priority":1,"issue_type":"bug","owner":"micahmartin@gmail.com","created_at":"2026-02-28T14:41:07.472161-07:00","created_by":"Micah","updated_at":"2026-02-28T14:41:07.472161-07:00"}
{"id":"zaap-eky","title":"Fix mic button permanently disabled when no Discord sessions load from gateway","description":"The mic button is permanently disabled because no sessions pass the Discord filter â€” channelType field is missing from gateway response.\n\n## Root Cause\ngateway sessions.list response does NOT include a 'channelType' field. The filter:\n  sessions = result.filter { $0.channelType == \"discord\" }\n...drops ALL sessions since channelType is always nil.\n\nSession key format reveals channel: 'agent:main:discord:CHANNELID'\n\n## Fix\n1. Derive channelType from session key in handleSessionListResponse:\n   - key contains ':discord:' â†’ channelType = 'discord'\n   - key == 'agent:main:main' â†’ channelType = 'main'\n   - else â†’ channelType = other\n\n2. Remove the Discord-only filter â€” show all sessions.\n\n3. Auto-select default session â€” do NOT require manual selection:\n   - First preference: key == 'agent:main:main' (always exists in OpenClaw)\n   - Fallback: most recently active session\n   - Mic button always enabled regardless of selection state\n\n4. Keep the picker visible so the user CAN switch sessions, but the main session is pre-selected.\n\n## Files\n- Zaap/Zaap/GatewayConnection.swift (handleSessionListResponse â€” derive channelType from key)\n- Zaap/Zaap/SessionPickerViewModel.swift (auto-select main session, remove Discord filter, remove isSessionSelected gate)","status":"closed","priority":0,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T16:29:20.405022-07:00","created_by":"Zane","updated_at":"2026-02-27T16:48:15.755344-07:00","closed_at":"2026-02-27T16:48:15.755347-07:00"}
{"id":"zaap-esx","title":"Voice pairing: Use gateway bearer token from settings instead of hardcoded fallback","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-24T11:03:32.622877-07:00","created_by":"zane","updated_at":"2026-02-24T11:08:09.654494-07:00","closed_at":"2026-02-24T11:08:09.654498-07:00"}
{"id":"zaap-fc0","title":"Dashboard: fix X-axis to always show 7 days","description":"The chart X-axis auto-scales based on data, showing hours when only today has data. It should always show exactly 7 days (today minus 6 days through end of today). Use .chartXScale(domain: sevenDaysAgo...endOfToday) to fix the domain. Also use .chartXAxis with AxisMarks(values: .stride(by: .day)) to force day-level labels. This makes the chart always read as a 7-day view regardless of how much data exists.","status":"closed","priority":1,"issue_type":"bug","assignee":"zane","created_at":"2026-02-20T14:33:37.099422-07:00","created_by":"zane","updated_at":"2026-02-20T14:34:33.577421-07:00","closed_at":"2026-02-20T14:34:33.577425-07:00"}
{"id":"zaap-fkp","title":"Per-service path routing â€” base URL is /hooks, each service appends its own path","description":"Change webhook architecture: user enters base URL (e.g. https://host/hooks). Each delivery service appends its own path segment: LocationDeliveryService posts to /location, SleepDeliveryService to /sleep, HeartRateDeliveryService to /heartrate, ActivityDeliveryService to /activity, WorkoutDeliveryService to /workout. Update WebhookClient.post() calls in all services. Fix crash on invalid URL.","status":"closed","priority":1,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-16T21:02:36.182265-07:00","created_by":"micahmartin","updated_at":"2026-02-16T22:25:12.5709-07:00","closed_at":"2026-02-16T22:25:12.570904-07:00"}
{"id":"zaap-fwm","title":"Fix silence timer cleanup on short utterance early return","description":"In VoiceEngine.emitUtteranceIfValid(), when the transcript fails the minimumTranscriptLength check (\u003c 3 chars), the function returns early WITHOUT invalidating the silence timer. This leaves the system in limbo â€” no utterance emitted, no timer reset. Fix: invalidate and reset the silence timer on early return so the next speech event properly re-arms detection.","status":"closed","priority":1,"issue_type":"bug","owner":"micahmartin@gmail.com","created_at":"2026-02-28T14:41:01.532548-07:00","created_by":"Micah","updated_at":"2026-02-28T15:02:30.832429-07:00","closed_at":"2026-02-28T15:02:30.83243-07:00","close_reason":"Closed"}
{"id":"zaap-g3w","title":"Session picker not populated from gateway â€” fix RPC and filter to discord + main sessions","description":"The session picker only shows the static 'Main' fallback. The sessions.list RPC either fails silently or returns sessions that are all filtered out.\n\n## Root Cause to Investigate\n1. Is the RPC call actually being made? (add logging in loadSessions)\n2. Is the gateway responding with sessions? (log the raw response)\n3. Is operator.read scope being granted? (log hello-ok auth.scopes from gateway response)\n\n## Filter Requirements\nShow ONLY these session types:\n- Sessions where key == 'agent:main:main' (always shown, labeled 'Main')\n- Sessions where key contains ':discord:' (Discord channels, labeled by channel name or derivedTitle)\n- Exclude: cron sessions, hook sessions, sub-agent sessions, telegram, etc.\n\n## Acceptance Criteria\n- [ ] Add logging in loadSessions() that prints: number of sessions returned, and each session key\n- [ ] Log the hello-ok payload to confirm operator.read is in auth.scopes\n- [ ] Filter: sessions = result.filter { /bin/zsh.key == 'agent:main:main' || /bin/zsh.key.contains(':discord:') }\n- [ ] Static 'Main' fallback always present (even if RPC fails)\n- [ ] After fix: picker shows 'Main' + Discord channel sessions from the gateway\n- [ ] Verify by running app and checking logs: sessions.list returns \u003e0 results\n\n## Files\nZaap/Zaap/SessionPickerViewModel.swift\nZaap/Zaap/GatewayConnection.swift","status":"closed","priority":1,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T18:06:03.35964-07:00","created_by":"Zane","updated_at":"2026-02-27T21:28:08.81436-07:00","closed_at":"2026-02-27T21:28:08.814362-07:00"}
{"id":"zaap-h24","title":"Pre-push hook simulator device name should be configurable","description":"The pre-push coverage hook hardcodes 'iPhone 17 Pro' as the simulator destination. This breaks when the machine has different simulators available. Should auto-detect an available iPhone simulator or read from a config file.","status":"closed","priority":2,"issue_type":"task","assignee":"zane","created_at":"2026-02-19T16:10:18.062109-07:00","created_by":"zane","updated_at":"2026-02-19T16:20:06.087549-07:00","closed_at":"2026-02-19T16:20:06.087552-07:00"}
{"id":"zaap-ho4","title":"Funnel persistence â€” tailscale serve overwrites funnel on gateway restart","description":"Every gateway restart runs tailscale serve which resets funnel back to tailnet-only. Zaap on iPhone can't reach the server until funnel is manually re-enabled. Need a post-restart hook or launchd script that runs 'tailscale funnel --bg --set-path / http://127.0.0.1:18789' after gateway starts. This is a zane-setup issue, not a Zaap code issue â€” but it blocks Zaap from working reliably.","status":"closed","priority":1,"issue_type":"bug","assignee":"zane","created_at":"2026-02-19T16:10:12.827707-07:00","created_by":"zane","updated_at":"2026-02-19T16:22:12.167102-07:00","closed_at":"2026-02-19T16:22:12.167105-07:00"}
{"id":"zaap-ikp","title":"Fix voice pairing 'Disconnected from gateway' issue with correct bearer token","notes":"Added Bearer token to WebSocket HTTP upgrade request. Branch: fix/bearer-token-websocket.","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","created_at":"2026-02-26T09:34:44.880984-07:00","created_by":"zane","updated_at":"2026-02-26T21:46:50.526564-07:00","closed_at":"2026-02-26T21:46:50.526572-07:00"}
{"id":"zaap-je2","title":"Hide 'Recognition request was canceled' error from chat transcript","description":"When the speech recognizer is canceled (e.g. during stopListening()), the error 'Recognition request was canceled' appears as a yellow warning in the chat transcript. This is an internal implementation detail and must not be shown to the user.\n\n## Acceptance Criteria\n- [ ] Grep VoiceEngine.swift and VoiceChatViewModel.swift â€” 'Recognition request was canceled' (or recognitionFailed errors from cancellations) must be swallowed, not forwarded to the UI\n- [ ] In VoiceEngine, filter out errors where error.localizedDescription contains 'canceled' or error code 301 (kAFAssistantErrorDomain canceled)\n- [ ] No yellow warning bubbles in the chat from speech recognizer cancellations","status":"closed","priority":1,"issue_type":"task","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-28T07:58:08.869948-07:00","created_by":"Zane","updated_at":"2026-02-28T08:00:05.776794-07:00","closed_at":"2026-02-28T08:00:05.776796-07:00"}
{"id":"zaap-jgm","title":"Echo cancellation not working â€” mic still picks up speaker output","description":"Despite setting AVAudioSession mode to .voiceChat, TTS speaker output is still fed back into the microphone.\n\n## Acceptance Criteria\n- [ ] Run the app, start a voice session, speak a prompt, let the assistant respond via TTS â€” the assistant must NOT hear its own voice and respond again\n- [ ] Verify in VoiceEngineAdapters.swift that setCategory is called with mode: .voiceChat (grep for voiceChat)\n- [ ] Verify the audio session is configured BEFORE audioEngine.start() is called\n- [ ] If voiceChat mode alone is insufficient: implement mic muting while AVSpeechSynthesizer is speaking â€” subscribe to AVSpeechSynthesizerDelegate willSpeakRangeOfSpeechString and didFinish; call audioEngine.pause()/resume() or inputNode volume = 0/1\n- [ ] Add a test or log line confirming AEC is active\n\n## Definition of Done\nWorker must paste the relevant code diff AND confirm echo no longer occurs by describing what changed and why it prevents feedback.","status":"closed","priority":0,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T17:55:34.308544-07:00","created_by":"Zane","updated_at":"2026-02-27T21:11:43.482204-07:00","closed_at":"2026-02-27T21:11:43.48221-07:00"}
{"id":"zaap-jod","title":"Crash hardening â€” eliminate all force unwraps and thread-safety issues","description":"App crashes on device when toggling location. Root causes: 1) CLLocationManager may be initialized off main thread via lazy static singleton. 2) 15 force unwraps across HealthKit readers. 3) No failure-path tests. Fix all force unwraps, ensure main-thread initialization, add failure-path tests.","status":"closed","priority":0,"issue_type":"bug","assignee":"zane","created_at":"2026-02-18T22:49:17.643279-07:00","created_by":"zane","updated_at":"2026-02-19T22:50:00.61308-07:00","closed_at":"2026-02-19T22:50:00.613082-07:00"}
{"id":"zaap-k20","title":"Remove navigation titles from all tabs (Voice, Settings, Dashboard)","description":"All tabs have redundant navigation titles that waste vertical space. The tab bar already identifies each tab.\n\n## Fix\nRemove .navigationTitle() (or set to '') and hide the navigation bar on:\n- VoiceChatView.swift\n- SettingsView.swift  \n- DashboardView.swift (if it has one too)\n\nUse .navigationBarHidden(true) or .toolbar(.hidden, for: .navigationBar) on each view.","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T16:35:02.830284-07:00","created_by":"Zane","updated_at":"2026-02-27T16:53:57.106089-07:00","closed_at":"2026-02-27T16:53:57.106094-07:00"}
{"id":"zaap-ku4","title":"Sleep webhook â€” POST morning sleep summary to /hooks/health","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T11:56:33.398409-07:00","created_by":"micahmartin","updated_at":"2026-02-15T19:48:10.048735-07:00","closed_at":"2026-02-15T19:48:10.048738-07:00","dependencies":[{"issue_id":"zaap-ku4","depends_on_id":"zaap-2xf","type":"blocks","created_at":"2026-02-15T11:56:40.109537-07:00","created_by":"micahmartin"},{"issue_id":"zaap-ku4","depends_on_id":"zaap-t8f","type":"blocks","created_at":"2026-02-15T11:56:40.224255-07:00","created_by":"micahmartin"}]}
{"id":"zaap-l06","title":"CRASH FIX: Replace background URLSession async/await with standard URLSession","description":"Root cause identified from crash report (Zaap-2026-02-19-102926.ips):\n\nCRASH: NSURLBackgroundSession throws ObjC exception when using async/await upload(for:fromFile:). This is an iOS limitation â€” background sessions do NOT support Swift concurrency async/await on real devices (works in simulator).\n\nStack trace: __NSURLBackgroundSession _onqueue_dummyTaskForClass â†’ objc_exception_throw â†’ SIGABRT\n\nFIX: Replace the background URLSession in WebhookClient with a standard URLSession.default. Use upload(for:from:) with Data instead of fromFile. Background delivery can be revisited later with proper delegate-based approach if needed.\n\nFiles to change:\n- WebhookClient.swift: Remove backgroundSession, use foregroundSession for everything\n- Remove SessionDelegate class (no longer needed without background session)","status":"closed","priority":0,"issue_type":"bug","assignee":"zane","created_at":"2026-02-19T10:35:27.979927-07:00","created_by":"zane","updated_at":"2026-02-19T11:49:45.357632-07:00","closed_at":"2026-02-19T11:49:45.357659-07:00"}
{"id":"zaap-l1a","title":"Dashboard: sync legend and bar color order","description":"The legend colors don't match the bar colors in the grouped chart. Swift Charts renders bars in the order they appear in the data, but the legend order may differ. Fix by ensuring the chartForegroundStyleScale keys are in the same order as the data types appear in the chart, and use .chartLegend with explicit ordering if needed. Desired order: Location (blue), Sleep (indigo), Heart Rate (red), Activity (green), Workouts (orange).","status":"closed","priority":1,"issue_type":"bug","assignee":"zane","created_at":"2026-02-20T14:35:02.926584-07:00","created_by":"zane","updated_at":"2026-02-20T14:36:34.401157-07:00","closed_at":"2026-02-20T14:36:34.40116-07:00"}
{"id":"zaap-l6q","title":"VoiceChatView â€” UI with idle/listening/processing/speaking states","description":"Implement VoiceChatView as a new tab in MainTabView. States: Idle (mic icon, tap to start), Listening (animated waveform, partial transcript shown), Processing (thinking indicator), Speaking (animated speaker, response text shown). Shows conversation log (user utterances + agent responses). Requires GatewayConnection + VoiceEngine + ResponseSpeaker.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-20T10:16:02.306307-07:00","created_by":"zane","updated_at":"2026-02-20T23:19:23.012281-07:00","closed_at":"2026-02-20T23:19:23.012284-07:00","dependencies":[{"issue_id":"zaap-l6q","depends_on_id":"zaap-89d","type":"blocks","created_at":"2026-02-20T10:16:28.21973-07:00","created_by":"zane"},{"issue_id":"zaap-l6q","depends_on_id":"zaap-0s7","type":"blocks","created_at":"2026-02-20T10:16:28.394407-07:00","created_by":"zane"},{"issue_id":"zaap-l6q","depends_on_id":"zaap-a0t","type":"blocks","created_at":"2026-02-20T10:16:28.578776-07:00","created_by":"zane"}]}
{"id":"zaap-l6r","title":"Workout session reader + delivery â€” read completed workouts and POST to webhook","description":"Read HKWorkout sessions from HealthKit (type, duration, calories, distance, HR zones if available). POST workout summaries to webhook.","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T19:31:39.112672-07:00","created_by":"micahmartin","updated_at":"2026-02-15T19:38:55.521277-07:00","closed_at":"2026-02-15T19:38:55.521284-07:00"}
{"id":"zaap-lxv","title":"Tab bar navigation â€” Dashboard + Settings","description":"Add a TabView with two tabs: Dashboard (home, bar chart) and Settings (existing SettingsView). Dashboard is the default/first tab.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-16T13:32:36.808874-07:00","created_by":"micahmartin","updated_at":"2026-02-16T14:09:07.027806-07:00","closed_at":"2026-02-16T14:09:07.02781-07:00","dependencies":[{"issue_id":"zaap-lxv","depends_on_id":"zaap-8by","type":"blocks","created_at":"2026-02-16T13:32:41.727072-07:00","created_by":"micahmartin"}]}
{"id":"zaap-m92","title":"Update voice chat tests for conversation mode behavior","description":"Update VoiceChatCoordinatorTests and VoiceChatViewModelTests to reflect new behavior: (1) Mic is NOT stopped when speaker starts (remove/invert existing echo-mute tests). (2) After TTS finishes with conversationMode on, state cycles to .listening. (3) Tapping mic toggles conversationMode on/off. (4) User interrupt during TTS still works (speaker.interrupt called on utterance complete).","status":"closed","priority":1,"issue_type":"task","owner":"micahmartin@gmail.com","created_at":"2026-02-28T10:40:32.764725-07:00","created_by":"Micah","updated_at":"2026-02-28T11:06:24.89806-07:00","closed_at":"2026-02-28T11:06:24.898063-07:00","dependencies":[{"issue_id":"zaap-m92","depends_on_id":"zaap-v56","type":"blocks","created_at":"2026-02-28T10:40:36.699475-07:00","created_by":"Micah"},{"issue_id":"zaap-m92","depends_on_id":"zaap-pe4","type":"blocks","created_at":"2026-02-28T10:40:36.789382-07:00","created_by":"Micah"}]}
{"id":"zaap-mu5","title":"Request log â€” add Copy button to each log entry","description":"Add a copy button (or tap-to-copy) to each request log entry in the Settings view. Tapping it should copy the full details to the clipboard: timestamp, path, status code, response time, and JSON body. Use UIPasteboard.general.string. A brief 'Copied!' confirmation (toast or button label change) would be a nice touch.","status":"closed","priority":2,"issue_type":"task","assignee":"zane","created_at":"2026-02-19T23:36:40.540943-07:00","created_by":"zane","updated_at":"2026-02-19T23:41:21.658061-07:00","closed_at":"2026-02-19T23:41:21.658064-07:00"}
{"id":"zaap-n0b","title":"Request log â€” merge request and response into single entry","description":"Currently the request log shows the request body separately from the response/error, which is confusing. Merge both into a single log entry row showing: [status dot] /path  NNNms | timestamp | error message or status code. The JSON body should be accessible via expand/tap (collapsible), not shown by default. One clean line per request, not two separate items.","notes":"Implemented summaryLine computed property on RequestLogEntry and updated RequestLogEntryRow to show a single condensed line per request. Added 4 tests, all 15 RequestLog tests pass.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-19T23:40:11.118635-07:00","created_by":"zane","updated_at":"2026-02-20T21:13:33.512361-07:00","closed_at":"2026-02-20T21:13:33.512366-07:00"}
{"id":"zaap-ncw","title":"Dashboard: add Y-axis scale to delivery chart","description":"Add a visible Y-axis scale to the Swift Charts bar chart in DashboardView so users can read delivery counts. Use .chartYAxis with gridlines and labeled tick marks. The scale should auto-size based on the max count in the data. Keep the chart clean â€” gridlines subtle (opacity ~0.3), labels in secondary color.","status":"closed","priority":2,"issue_type":"task","assignee":"zane","created_at":"2026-02-20T10:41:41.093604-07:00","created_by":"zane","updated_at":"2026-02-20T10:43:00.672411-07:00","closed_at":"2026-02-20T10:43:00.672414-07:00"}
{"id":"zaap-nll","title":"Settings: Group gateway bearer token with hostname and hooks token, add dev/prod toggle","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-24T11:03:27.875883-07:00","created_by":"zane","updated_at":"2026-02-24T11:06:39.953165-07:00","closed_at":"2026-02-24T11:06:39.953169-07:00"}
{"id":"zaap-o8k","title":"HealthKit observer queries â€” background delivery triggered by data changes","description":"Replace one-shot-on-launch delivery with HKObserverQuery + enableBackgroundDelivery for all HealthKit types. When the Apple Watch or any app writes new data, iOS wakes Zaap and it fetches+delivers immediately.\n\nImplementation:\n- Heart rate: .immediate â€” fires as watch records samples\n- Workouts: .immediate â€” fires when workout session ends\n- Activity/Steps: .hourly â€” steps update constantly, hourly batching is fine\n- Sleep: .immediate â€” fires when sleep session is written\n\nAdd HealthKitObserverService that:\n1. Calls enableBackgroundDelivery(for:frequency:) for each type\n2. Registers HKObserverQuery for each type\n3. On query callback: fetch latest data and call the relevant delivery service\n4. Calls the completion handler to tell iOS the background task is done (critical â€” or iOS throttles future wakes)\n\nInfo.plist: add 'fetch' to UIBackgroundModes if not already present.\n\nThis replaces the current deliverLatest() on-launch pattern for sleep/activity. Location already uses CLLocationManager significant changes (keep as-is).","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-20T10:36:34.150646-07:00","created_by":"zane","updated_at":"2026-02-20T23:20:14.338162-07:00","closed_at":"2026-02-20T23:20:14.338167-07:00"}
{"id":"zaap-p0e","title":"Replace voice connection handshake with new WebSocket protocol","description":"Implement the new WebSocket handshake protocol to replace the current voice connection handshake.\n\n## Current State\nThe existing voice connection handshake needs to be replaced with a more robust WebSocket protocol.\n\n## New Protocol Requirements\n\n### Step 1: WebSocket Connection\n- Connect to: wss://zanebot.tail66e5f8.ts.net\n\n### Step 2: Challenge Handling  \n- Receive challenge with nonce and timestamp from gateway\n- Save nonce for signature generation\n\n### Step 3: Device Identity (Ed25519)\n- Generate Ed25519 keypair (one-time, persistent)\n- deviceId = SHA-256 of raw public key bytes (hex)\n- publicKey = raw 32-byte public key, base64url-encoded\n\n### Step 4: Signature Generation (v3)\n- Build payload: v3|deviceId|clientId|clientMode|role|scopes|signedAtMs|token|nonce|platform|deviceFamily\n- Sign with Ed25519 private key\n- Base64url encode signature\n\n### Step 5: Connect Request\n- Send structured connect request with auth, device, and signature details\n- Handle pairing flow for new devices (code 1008)\n- Store deviceToken for future connections\n\n### Key Implementation Notes\n- Use CryptoKit Curve25519.Signing for Ed25519 in Swift\n- Store keypair in Keychain permanently  \n- publicKey is raw 32 bytes base64url (not PEM)\n- All string fields lowercase ASCII\n- deviceToken can replace bearer token on subsequent connects\n\n## Acceptance Criteria\n- [ ] WebSocket connection established\n- [ ] Ed25519 keypair generation and storage\n- [ ] Challenge/response flow implemented\n- [ ] Signature generation working\n- [ ] Connect request properly formatted\n- [ ] Pairing flow handled\n- [ ] deviceToken persistence\n- [ ] Error handling for connection failures","notes":"Worker made partial changes (v2â†’v3 signature) but missed the main requirement: implementing new WebSocket handshake to replace current voice connection. Need full protocol replacement per original spec.","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-26T18:19:41.947075-07:00","created_by":"Zane","updated_at":"2026-02-26T21:03:53.800832-07:00","closed_at":"2026-02-26T21:03:53.800837-07:00"}
{"id":"zaap-pe4","title":"Update VoiceChatViewModel for conversation mode cycling","description":"handleResponseComplete() currently always goes to .idle. When conversation mode is active, it should go to .listening instead so the UI stays red and shows the mic-active state. Add a parameter or callback so the coordinator can tell the VM whether to cycle back to listening or go idle.","status":"closed","priority":1,"issue_type":"task","owner":"micahmartin@gmail.com","created_at":"2026-02-28T10:40:29.735665-07:00","created_by":"Micah","updated_at":"2026-02-28T10:54:10.201115-07:00","closed_at":"2026-02-28T10:54:10.201116-07:00"}
{"id":"zaap-pvp","title":"Hostname-only settings â€” auto-build webhook URLs from hostname","description":"Change Settings from full URL input to hostname-only. App builds https://\u003chostname\u003e/hooks/\u003cservice\u003e automatically. Reduces user error. Also deferred service start to .task{} to prevent launch crashes.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-18T08:13:42.243506-07:00","created_by":"micahmartin","updated_at":"2026-02-18T08:13:46.806005-07:00","closed_at":"2026-02-18T08:13:46.806005-07:00","close_reason":"Closed"}
{"id":"zaap-q2l","title":"Heart rate reader + delivery â€” read HR samples from HealthKit and POST to webhook","description":"HealthKit HKQuantityType heartRate reader. Collect resting HR, recent samples, and daily min/max/avg. POST to webhook endpoint.","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T19:31:38.590041-07:00","created_by":"micahmartin","updated_at":"2026-02-15T19:42:10.584884-07:00","closed_at":"2026-02-15T19:42:10.584889-07:00"}
{"id":"zaap-q3v","title":"App icon concepts â€” generate 3+ distinct design directions for review","description":"Create at least 3 distinct app icon concepts (1024x1024 PNG each) for Zaap. Each should explore a different visual direction while staying on-brand (lightning/zap/telemetry/data themes). Save all concepts to .project/iterations/003/assets/ for review. Present to Micah in #zaap for selection and refinement.","status":"closed","priority":1,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-16T14:23:04.746308-07:00","created_by":"micahmartin","updated_at":"2026-02-19T10:05:16.825897-07:00","closed_at":"2026-02-19T10:05:16.825913-07:00"}
{"id":"zaap-q8a","title":"Add XCTest target and backfill tests for all existing features","description":"Create a ZaapTests target in the Xcode project. Following the TDD skill (~/.openclaw/skills/tdd/SKILL.md), write tests for all existing code: SettingsManager, WebhookClient, LocationManager, LocationDeliveryService, SleepDataReader, SleepDeliveryService, HeartRateReader, HeartRateDeliveryService, ActivityReader, ActivityDeliveryService, WorkoutReader, WorkoutDeliveryService. Use protocol-based abstractions where needed to make HealthKit/CLLocation code testable. Ensure all tests pass in the simulator.","status":"closed","priority":1,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T19:34:53.598791-07:00","created_by":"micahmartin","updated_at":"2026-02-16T09:04:04.580736-07:00","closed_at":"2026-02-16T09:04:04.580738-07:00"}
{"id":"zaap-qrc","title":"Remove 'Voice' navigation title from voice tab","description":"The voice tab has a 'Voice' header/navigation title that wastes vertical space. Remove it.\n\n## Fix\nIn VoiceChatView.swift, remove or set .navigationTitle('') and .navigationBarHidden(true) (or .toolbar(.hidden, for: .navigationBar)) so the tab uses the full screen height for the conversation.\n\n## File\nZaap/Zaap/VoiceChatView.swift","status":"closed","priority":2,"issue_type":"task","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T16:34:42.446103-07:00","created_by":"Zane","updated_at":"2026-02-27T16:35:07.794915-07:00","closed_at":"2026-02-27T16:35:07.794918-07:00"}
{"id":"zaap-r25","title":"Webhook test button â€” verify config with a ping request","description":"Add a 'Test Connection' button in Settings under the webhook config section. Sends a lightweight test POST to the webhook URL. Shows success/failure inline. Must not crash on invalid URL or missing config â€” handle errors gracefully.","status":"closed","priority":1,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-16T21:02:35.98372-07:00","created_by":"micahmartin","updated_at":"2026-02-16T22:30:01.501126-07:00","closed_at":"2026-02-16T22:30:01.50113-07:00","dependencies":[{"issue_id":"zaap-r25","depends_on_id":"zaap-fkp","type":"blocks","created_at":"2026-02-17T06:42:32.185412-07:00","created_by":"micahmartin"}]}
{"id":"zaap-st5","title":"Bonjour discovery â€” auto-find OpenClaw gateway on local network","description":"Use NWBrowser to discover _openclaw._tcp services on the local network. Show discovered gateways in a picker in Settings instead of requiring manual IP entry. Store selected gateway in UserDefaults. Fall back to manual entry if no gateways found.","status":"closed","priority":2,"issue_type":"task","assignee":"zane","created_at":"2026-02-20T10:16:02.866861-07:00","created_by":"zane","updated_at":"2026-02-20T23:05:30.372164-07:00","closed_at":"2026-02-20T23:05:30.372167-07:00"}
{"id":"zaap-t8f","title":"Webhook client â€” POST location data to configured endpoint with Bearer auth","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T11:56:32.730627-07:00","created_by":"micahmartin","updated_at":"2026-02-15T12:02:43.398623-07:00","closed_at":"2026-02-15T12:02:43.398627-07:00","dependencies":[{"issue_id":"zaap-t8f","depends_on_id":"zaap-7xm","type":"blocks","created_at":"2026-02-15T11:56:39.520806-07:00","created_by":"micahmartin"}]}
{"id":"zaap-uao","title":"Hide dev/prod config toggle on real devices - should only appear in simulator","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","created_at":"2026-02-26T09:34:34.546553-07:00","created_by":"zane","updated_at":"2026-02-26T21:26:36.308612-07:00","closed_at":"2026-02-26T21:26:36.308616-07:00"}
{"id":"zaap-v56","title":"Add conversationMode bool to VoiceChatCoordinator","description":"Add a conversationMode boolean to the coordinator. When true, the voice pipeline stays active across the listenâ†’processâ†’speak cycle. Changes: (1) Remove voiceEngine.stopListening() from speaker.onStateChange when speaker starts speaking â€” trust .voiceChat AEC. (2) When speaker finishes and conversationMode is on, transition state to .listening instead of .idle. (3) startSession sets conversationMode=true, stopSession sets conversationMode=false. The mic button in the view already calls startSession/stopSession, so it becomes the toggle.","status":"closed","priority":1,"issue_type":"task","owner":"micahmartin@gmail.com","created_at":"2026-02-28T10:40:28.351735-07:00","created_by":"Micah","updated_at":"2026-02-28T10:59:05.160803-07:00","closed_at":"2026-02-28T10:59:05.160803-07:00","close_reason":"Closed"}
{"id":"zaap-v6u","title":"Wire DeliveryLogService into delivery service singletons â€” Dashboard shows No Deliveries","description":"All delivery services (Location, Sleep, HeartRate, Activity, Workout) default to NullDeliveryLog() and are never injected with a real DeliveryLogService. ZaapApp.startServices() calls .start() without setting a logger. Fix: add a configure(deliveryLog:) method (or make deliveryLog a var) on each delivery service, then in startServices() create DeliveryLogService(context: modelContainer.mainContext) and inject it into all services before calling .start(). Ensure tests still pass. No pre-push coverage run needed â€” just compile verify.","status":"closed","priority":0,"issue_type":"bug","assignee":"zane","created_at":"2026-02-20T10:14:11.47543-07:00","created_by":"zane","updated_at":"2026-02-20T10:15:53.032766-07:00","closed_at":"2026-02-20T10:15:53.03277-07:00"}
{"id":"zaap-vg7","title":"Voice should automatically use selected TTS voice from settings instead of separate selection","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","created_at":"2026-02-26T09:35:12.695831-07:00","created_by":"zane","updated_at":"2026-02-26T22:00:52.15435-07:00","closed_at":"2026-02-26T22:00:52.154352-07:00"}
{"id":"zaap-wcg","title":"Mic button off should stop both listening and speaking","description":"When the user taps the mic button to turn it off, it should stop both:\n1. Listening (voice input / speech recognition)\n2. Speaking (TTS / response playback)\n\nCurrently stopSession() stops listening and calls speaker.interrupt() but the speaking may continue. The mic button should be a hard stop for the entire voice interaction â€” nothing in, nothing out.","status":"closed","priority":2,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-26T21:05:22.214553-07:00","created_by":"Zane","updated_at":"2026-02-26T22:13:29.669551-07:00","closed_at":"2026-02-26T22:13:29.669562-07:00"}
{"id":"zaap-wwc","title":"Add Device ID display with copy button to Voice pairing screen for gateway configuration","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-26T11:52:14.578672-07:00","created_by":"zane","updated_at":"2026-02-26T15:21:55.705428-07:00","closed_at":"2026-02-26T15:21:55.705462-07:00"}
{"id":"zaap-x6c","title":"Settings screen â€” configure webhook URL, auth token, enable/disable location tracking","status":"closed","priority":2,"issue_type":"task","assignee":"micahmartin","created_at":"2026-02-15T11:56:32.89747-07:00","created_by":"micahmartin","updated_at":"2026-02-15T12:02:53.201641-07:00","closed_at":"2026-02-15T12:02:53.201647-07:00","dependencies":[{"issue_id":"zaap-x6c","depends_on_id":"zaap-7xm","type":"blocks","created_at":"2026-02-15T11:56:39.640731-07:00","created_by":"micahmartin"}]}
{"id":"zaap-xml","title":"Add gateway bearer token field to settings page under voice section","status":"closed","priority":2,"issue_type":"task","assignee":"zane","created_at":"2026-02-23T09:56:08.990361-07:00","created_by":"zane","updated_at":"2026-02-23T10:18:46.311923-07:00","closed_at":"2026-02-23T10:18:46.311926-07:00"}
{"id":"zaap-yhg","title":"Session picker: show Discord sessions only, require selection before voice","description":"The session picker only shows 'New conversation' â€” it's not loading sessions from the gateway.\n\n## Requirements\n1. Load sessions from the gateway via sessions.list RPC\n2. Filter to Discord sessions only (channel type = discord)\n3. Remove the 'New conversation' option â€” every voice conversation should be tied to an existing Discord session\n4. Require a session to be selected before the mic button is enabled\n5. Default to the most recently active Discord session\n\n## Root Cause Investigation Needed\nSessionPickerViewModel calls gateway.listSessions() but sessions may not be loading (RPC failing silently, or gateway not returning sessions). Check:\n- What the gateway actually returns for sessions.list\n- Whether GatewayConnection.listSessions() is implemented correctly\n- Add error logging if the RPC fails\n\n## Files\n- Zaap/Zaap/SessionPickerViewModel.swift\n- Zaap/Zaap/SessionPickerView.swift  \n- Zaap/Zaap/GatewayConnection.swift (listSessions implementation)","status":"closed","priority":1,"issue_type":"task","assignee":"Zane","owner":"assistantmicahmartin@gmail.com","created_at":"2026-02-27T15:59:30.378323-07:00","created_by":"Zane","updated_at":"2026-02-27T16:19:50.131554-07:00","closed_at":"2026-02-27T16:19:50.131557-07:00"}
{"id":"zaap-z75","title":"Design: Voice chat â€” research gateway WS protocol and architect voice conversation feature","description":"Research and design the voice conversation feature for Zaap.\n\nGoals:\n- User opens voice tab, starts talking (no push-to-talk â€” use voice activity detection)\n- SFSpeechRecognizer transcribes speech, detects end-of-utterance on silence\n- Transcript sent to OpenClaw gateway, response streamed back\n- AVSpeechSynthesizer speaks the response\n- Conversation stays open for back-and-forth\n\nResearch needed:\n1. Gateway WebSocket protocol â€” can Zaap connect as a node? The Android app already does this (ws://\u003chost\u003e:18789 with pairing). If Zaap implements the node protocol, it gets bidirectional chat for free.\n2. Alternative: custom WS endpoint or synchronous hook response\n3. iOS constraints: SFSpeechRecognizer continuous mode, background audio session, VAD silence detection thresholds\n4. TTS voice selection â€” AVSpeechSynthesizer voices vs ElevenLabs API\n\nDeliverable: Architecture doc in .braids/iterations/ with sequence diagrams, protocol choice, and implementation plan broken into sub-beads.","status":"closed","priority":1,"issue_type":"task","assignee":"zane","created_at":"2026-02-19T18:49:03.181019-07:00","created_by":"zane","updated_at":"2026-02-19T20:21:49.45598-07:00","closed_at":"2026-02-19T20:21:49.45598-07:00","close_reason":"Closed"}
{"id":"zaap-zq9","title":"Conversation mode toggle â€” persistent mic-hot voice chat","description":"Replace the current one-shot push-to-talk with a persistent conversation mode toggle. Tap mic once to enter conversation mode (red), tap again to exit (blue). When on: mic stays hot (no muting during TTS), TTS speaks responses, auto-cycles back to listening after TTS finishes. When off: no STT, no TTS. Trust iOS .voiceChat hardware AEC instead of muting mic. Sim has no AEC â€” test on real device.","status":"closed","priority":1,"issue_type":"feature","owner":"micahmartin@gmail.com","created_at":"2026-02-28T10:40:19.544666-07:00","created_by":"Micah","updated_at":"2026-02-28T11:21:50.905531-07:00","closed_at":"2026-02-28T11:21:50.905532-07:00","dependencies":[{"issue_id":"zaap-zq9","depends_on_id":"zaap-v56","type":"blocks","created_at":"2026-02-28T10:40:49.990212-07:00","created_by":"Micah"},{"issue_id":"zaap-zq9","depends_on_id":"zaap-pe4","type":"blocks","created_at":"2026-02-28T10:40:50.074732-07:00","created_by":"Micah"},{"issue_id":"zaap-zq9","depends_on_id":"zaap-m92","type":"blocks","created_at":"2026-02-28T10:40:50.166017-07:00","created_by":"Micah"}]}
